# Домашнее задание к занятию 17 «Инцидент-менеджмент» Нечаев Владимир

## Задание

Составьте постмортем на основе реального сбоя системы GitHub в 2018 году.

Информацию о сбое можно изучить по ссылкам ниже:

* [краткое описание на русском языке](https://habr.com/ru/post/427301/);
* [развёрнутое описание на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).

## Ответ:

* ### Краткое описание инцидента
  - В GitHub произошел инцидент, по причине регламентных работ по замене вышедшего из строя оптического оборудования, который привел к ухудшению качества обслуживания в течение 24 часов и 11 минут 

* ### Предшествующие события
  - Вышло из стороя сетевое оптическое оборудование между сетевым концентратором и дата центром на восточном побережье

* ### Причина инцидента
  - Потеря связи между сетевыми узлами Востока и Запада на 43 секунды в результате регламентных работ

* ### Воздействие
  - Были затронуты внутренние системы, что привело к отображению устаревшей и противоречивой информации, невозможность обслуслуживать события webhook, создавать и публиковать сайты GitHub Pages

* ### Обнаружение
  - Система мониторинга. Инженеры группы быстрого реагирования определили, что топологии многочисленных клстеров баз данных находятся в непредвиденном состоянии

* ### Реакция
  - Уведомление координатора инцидентов, привлечение инженеров из группы разработки баз данных GitHub. Изменение статуса сайта на красный. Инцидент устранили за 24 часов и 11 минут

* ### Восстановление
  - Восстановление из резервной копии и синхронизация реплик на обоих сайтах 

* ### Таймлайн
   - `2018 октябрь 21 22:52 UTC`
     - Плановые профилактические работы по замене вышедшего из строя оптического оборудования 100G, была потеряна связь между сетевым концентратором и основным центром обработки данных на 43 секуды
   - `2018 октябрь 21 22:52 UTC`
     - Система мониторинга начала генерировать оповещения на сбой. Дежурная смена инженеров определила что БД в режиме репликации, но в репликации отсутствует 
   - `2018 октябрь 21 23:07 UTC`
     - Заблокирован инструмент развертывания, для предотвращения внесения изменений, для предотвращения внесения изменений
   - `2018 октябрь 21 23:09 UTC`
     - Сайт переведен в желтый статус
   - `2018 октябрь 21 23:11 UTC`
     - Координатор инцидента изменил статус на красный
   - `2018 октябрь 21 23:13 UTC`
     - Были вызваны дополнительные инженеры из группы разработки. Принято решение восстановить кластеры баз данных из резервной копии и сохранить пользовательские данные, находящиеся в очереди
   - `2018 октябрь 21 23:19 UTC`
     - Отключение части сервисов (webhooks, GitHub Pages)
   - `2018 октябрь 22 00:05 UTC`
     - Принято решение восстановить кластер из резервной копии
   - `2018 октябрь 22 00:41 UTC`
     - Запуск восстановления
   - `2018 октябрь 22 06:51 UTC`
     - Несколько кластеров завершили восстановление, начата репликация новых данных
   - `2018 октябрь 22 07:46 UTC`
     - Публикация в блоге Incident Report о произошедшем сбое
   - `2018 октябрь 22 11:12 UTC`
     - Восстановлены первичные базы данных в ЦОД на восточном побережье
   - `2018 октябрь 22 13:15 UTC`
     - Фиксируется приближение к пиковой нагрузке трафика на GitHub.com. Группой реагирования приняты новые решения для ускорения репликации
   - `2018 октябрь 22 16:24 UTC`
     - Завершение синхронизации реплик, переключение на исходную топологию, начало обработки накопившихся данных из очередей
   - `2018 октябрь 22 16:45 UTC`
     - Восстановление данных из очереди, обработка данных с пропущенным TTL, временное увеличение TTL
   - `2018 октябрь 22 23:03 UTC`
     - Подтверждена целостность и правильная работа всех систем. Статус сайта обновлен до зеленого

* ### Последующие действия
  - Настройка конфигурациии Оркестратора чтобы исключить автоматическую миграцию кластеров между регионами
  - Переход на новый механизм отчетов о состоянии, который предоставит более полную информацию о том, что работает, а что нет, и в будущем позволит отображать состояние различных компонентов платформы независимо друг от друга
  - Внедрение поддержки дополнительного резервирования ресурсов на уровне N+1. Цель этой работы — допустить полный отказ одного центра обработки данных без воздействия на пользователя
  - Усиление проактивной работы по тестированию новых решений
  - Изменение мышления в отношении надежности сайта. Необходимо начать системную практику проверки сценариев сбоев до того, как они смогут повлиять на пользователя.
